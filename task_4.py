import numpy as np
import matplotlib.pyplot as plt

# фиксируем сид
np.random.seed(0) #начальное значение

# размеры скрытого слоя
sizes = [16, 64, 256] # состоит из нескольких нейронов, которые обрабатывают и преобразуют входные данные с помощью взвешенных связей и функций активации
stds = [] #список, куда сохраняются значения стандартного отклонения весов для каждой модели.

for h in sizes:
    # веса скрытого слоя: вход 32 признака, выход h нейронов
    W = np.random.randn(h, 32)
    stds.append(W.std()) #добавляет элемент в конец списка

# вывод результатов
for h, s in zip(sizes, stds):
    print(f"{h} нейронов – стандартное отклонение весов = {s:.6f}")

# график зависимости
plt.plot(sizes, stds, marker='o')
plt.xlabel("Число нейронов")
plt.ylabel("Стандартное отклонение весов")
plt.title("Зависимость std весов от числа нейронов")
plt.show()
